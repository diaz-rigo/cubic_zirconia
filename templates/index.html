<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Predicción de Precio de Circonitas</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='esty.css') }}">
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('predict-form').addEventListener('submit', function(event) {
                event.preventDefault(); // Evitar el envío por defecto del formulario

                // Recolectar datos del formulario
                const formData = new FormData(this);
                
                // Convertir los datos a un objeto JSON
                const jsonData = {};
                formData.forEach((value, key) => {
                    jsonData[key] = value;
                });

                // Mostrar los datos recolectados en la consola
                console.log('Datos del formulario:', jsonData);

                // Enviar los datos al servidor usando fetch
                fetch('/predict', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(jsonData)
                })
                .then(response => response.json())
                .then(data => {
                    // Mostrar el precio predicho y el nearby_price en el resultado
                    document.getElementById('resultado').innerHTML = `
                    <p>El precio predicho es: $${(data.nearby_price !== null ? data.nearby_price : data.prediction).toFixed(2)}</p>
                `;
                })
                .catch(error => {
                    console.error('Error al enviar solicitud:', error);
                    document.getElementById('resultado').innerHTML = '<p>Ocurrió un error al realizar la predicción. Por favor, inténtelo de nuevo.</p>';
                });
            });
        });
    </script>
</head>
<body>
    <h2>Ingrese los datos de la circonita:</h2>
    <form id="predict-form" method="post">
        <div class="form-group">
            <label for="carat">Carat:</label>
            <input type="text" id="carat" name="carat" required>
        </div>
        
        <div class="form-group">
            <label for="cut">Cut:</label>
            <select id="cut" name="cut" required>
                <option value="Ideal">Ideal</option>
                <option value="Premium">Premium</option>
                <option value="Very Good">Very Good</option>
                <option value="Good">Good</option>
                <option value="Fair">Fair</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="color">Color:</label>
            <select id="color" name="color" required>
                <option value="D">D</option>
                <option value="E">E</option>
                <option value="F">F</option>
                <option value="G">G</option>
                <option value="H">H</option>
                <option value="I">I</option>
                <option value="J">J</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="clarity">Clarity:</label>
            <select id="clarity" name="clarity" required>
                <option value="IF">IF</option>
                <option value="VVS1">VVS1</option>
                <option value="VVS2">VVS2</option>
                <option value="VS1">VS1</option>
                <option value="VS2">VS2</option>
                <option value="SI1">SI1</option>
                <option value="SI2">SI2</option>
                <option value="I1">I1</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="depth">Depth:</label>
            <input type="text" id="depth" name="depth" required>
        </div>
        
        <div class="form-group">
            <label for="table">Table:</label>
            <input type="text" id="table" name="table" required>
        </div>
        
        <div class="form-group">
            <label for="x">X:</label>
            <input type="text" id="x" name="x" required>
        </div>
        
        <div class="form-group">
            <label for="y">Y:</label>
            <input type="text" id="y" name="y" required>
        </div>
        
        <div class="form-group">
            <label for="z">Z:</label>
            <input type="text" id="z" name="z" required>
        </div>
        
        <input type="submit" value="Predecir">
    </form>
    
    <div id="resultado"></div>
</body>
</html>
